training save in path: ./work_dir/gta/vit_base_patch16_rope_reg1_gap_256.sbb_in1k/0918151735
training start from None

Model: vit_base_patch16_rope_reg1_gap_256.sbb_in1k
{'input_size': (3, 256, 256), 'interpolation': 'bicubic', 'mean': (0.5, 0.5, 0.5), 'std': (0.5, 0.5, 0.5), 'crop_pct': 0.95, 'crop_mode': 'center'}
Freeze model layers: False [0, 0, 0, 0]
GPUs available: 8

Image Size Query: (384, 384)
Image Size Ground: (384, 384)
Mean: (0.5, 0.5, 0.5)
Std:  (0.5, 0.5, 0.5)

Use custom sampling: True
Query Images Test: 9067
Gallery Images Test: 14640
Train with weight? True k= 5.0

Scheduler: cosine - max LR: 0.0001
Warmup Epochs: 0.1 - Warmup Steps: 358.5
Train Epochs:  5 - Train Steps:  17925

------------------------------[Epoch: 1]------------------------------

Shuffle Dataset:
Original Length: 71686 - Length after Shuffle: 70840
Break Counter: 16384
Pairs left out of last batch to avoid creating noise: 846
First Element: /data3/czh_code/gta/GTA-UAV-LR/drone/images/100_0001_0000005334.png - Last Element: /data3/czh_code/gta/GTA-UAV-LR/drone/images/500_0001_0000024416.png
First Element: /data3/czh_code/gta/GTA-UAV-LR/satellite/6_0_8_32.png - Last Element: /data3/czh_code/gta/GTA-UAV-LR/satellite/5_0_9_22.png
Iteration 1/3542 took 2.5745 s, ETA: 12248.20 s, loss: 2.6310, loss_avg: ('2.6310',), lr: 0.000000, contrastive: 2.6310, 
Iteration 51/3542 took 0.2804 s, ETA: 1186.79 s, loss: 2.2006, loss_avg: ('2.4991',), lr: 0.000014, contrastive: 2.2006, 
Iteration 101/3542 took 0.2902 s, ETA: 1078.43 s, loss: 1.6735, loss_avg: ('2.2758',), lr: 0.000028, contrastive: 1.6735, 
Iteration 151/3542 took 0.2887 s, ETA: 1027.16 s, loss: 1.8739, loss_avg: ('2.1298',), lr: 0.000042, contrastive: 1.8739, 
Iteration 201/3542 took 0.2818 s, ETA: 999.23 s, loss: 1.7520, loss_avg: ('2.0368',), lr: 0.000056, contrastive: 1.7520, 
Iteration 251/3542 took 0.2705 s, ETA: 970.04 s, loss: 1.8386, loss_avg: ('1.9606',), lr: 0.000070, contrastive: 1.8386, 
Iteration 301/3542 took 0.3127 s, ETA: 952.25 s, loss: 1.5325, loss_avg: ('1.9050',), lr: 0.000084, contrastive: 1.5325, 
Iteration 351/3542 took 0.2513 s, ETA: 931.96 s, loss: 1.6423, loss_avg: ('1.8640',), lr: 0.000098, contrastive: 1.6423, 
Iteration 401/3542 took 0.3127 s, ETA: 915.24 s, loss: 1.6018, loss_avg: ('1.8272',), lr: 0.000100, contrastive: 1.6018, 
Iteration 451/3542 took 0.2895 s, ETA: 898.59 s, loss: 1.6400, loss_avg: ('1.7943',), lr: 0.000100, contrastive: 1.6400, 
Iteration 501/3542 took 0.2821 s, ETA: 882.03 s, loss: 1.4887, loss_avg: ('1.7676',), lr: 0.000100, contrastive: 1.4887, 
Iteration 551/3542 took 0.3103 s, ETA: 866.91 s, loss: 1.5120, loss_avg: ('1.7422',), lr: 0.000100, contrastive: 1.5120, 
Iteration 601/3542 took 0.2825 s, ETA: 851.68 s, loss: 1.6326, loss_avg: ('1.7230',), lr: 0.000100, contrastive: 1.6326, 
Iteration 651/3542 took 0.2721 s, ETA: 838.53 s, loss: 1.5477, loss_avg: ('1.7055',), lr: 0.000100, contrastive: 1.5477, 
Iteration 701/3542 took 0.2827 s, ETA: 821.74 s, loss: 1.4291, loss_avg: ('1.6874',), lr: 0.000100, contrastive: 1.4291, 
Iteration 751/3542 took 0.2868 s, ETA: 805.67 s, loss: 1.6382, loss_avg: ('1.6766',), lr: 0.000100, contrastive: 1.6382, 
Iteration 801/3542 took 0.2802 s, ETA: 792.29 s, loss: 1.5539, loss_avg: ('1.6637',), lr: 0.000100, contrastive: 1.5539, 
Iteration 851/3542 took 0.3192 s, ETA: 776.13 s, loss: 1.5141, loss_avg: ('1.6533',), lr: 0.000100, contrastive: 1.5141, 
Iteration 901/3542 took 0.3247 s, ETA: 763.09 s, loss: 1.3128, loss_avg: ('1.6422',), lr: 0.000100, contrastive: 1.3128, 
Iteration 951/3542 took 0.2840 s, ETA: 749.18 s, loss: 1.7015, loss_avg: ('1.6314',), lr: 0.000100, contrastive: 1.7015, 
Iteration 1001/3542 took 0.2888 s, ETA: 734.56 s, loss: 1.4003, loss_avg: ('1.6204',), lr: 0.000100, contrastive: 1.4003, 
Iteration 1051/3542 took 0.2722 s, ETA: 720.56 s, loss: 1.2081, loss_avg: ('1.6112',), lr: 0.000100, contrastive: 1.2081, 
Iteration 1101/3542 took 0.2893 s, ETA: 705.57 s, loss: 1.3252, loss_avg: ('1.6028',), lr: 0.000100, contrastive: 1.3252, 
Iteration 1151/3542 took 0.3022 s, ETA: 691.41 s, loss: 1.4663, loss_avg: ('1.5958',), lr: 0.000099, contrastive: 1.4663, 
Iteration 1201/3542 took 0.2951 s, ETA: 677.05 s, loss: 1.2804, loss_avg: ('1.5882',), lr: 0.000099, contrastive: 1.2804, 
Iteration 1251/3542 took 0.2834 s, ETA: 662.56 s, loss: 1.2757, loss_avg: ('1.5811',), lr: 0.000099, contrastive: 1.2757, 
Iteration 1301/3542 took 0.2882 s, ETA: 646.66 s, loss: 1.3196, loss_avg: ('1.5759',), lr: 0.000099, contrastive: 1.3196, 
Iteration 1351/3542 took 0.3462 s, ETA: 631.21 s, loss: 1.2802, loss_avg: ('1.5703',), lr: 0.000099, contrastive: 1.2802, 
Iteration 1401/3542 took 0.3031 s, ETA: 616.50 s, loss: 1.3196, loss_avg: ('1.5653',), lr: 0.000099, contrastive: 1.3196, 
Iteration 1451/3542 took 0.2543 s, ETA: 600.99 s, loss: 1.4369, loss_avg: ('1.5602',), lr: 0.000099, contrastive: 1.4369, 
Iteration 1501/3542 took 0.2452 s, ETA: 586.37 s, loss: 1.1504, loss_avg: ('1.5536',), lr: 0.000099, contrastive: 1.1504, 
Iteration 1551/3542 took 0.2722 s, ETA: 571.92 s, loss: 1.3467, loss_avg: ('1.5474',), lr: 0.000099, contrastive: 1.3467, 
Iteration 1601/3542 took 0.2856 s, ETA: 556.81 s, loss: 1.3890, loss_avg: ('1.5425',), lr: 0.000099, contrastive: 1.3890, 
Iteration 1651/3542 took 0.2793 s, ETA: 542.20 s, loss: 1.4462, loss_avg: ('1.5388',), lr: 0.000099, contrastive: 1.4462, 
Iteration 1701/3542 took 0.2882 s, ETA: 528.02 s, loss: 1.4540, loss_avg: ('1.5355',), lr: 0.000099, contrastive: 1.4540, 
Iteration 1751/3542 took 0.2807 s, ETA: 513.34 s, loss: 1.3078, loss_avg: ('1.5312',), lr: 0.000098, contrastive: 1.3078, 
Iteration 1801/3542 took 0.2990 s, ETA: 499.20 s, loss: 1.4103, loss_avg: ('1.5272',), lr: 0.000098, contrastive: 1.4103, 
Iteration 1851/3542 took 0.3021 s, ETA: 484.52 s, loss: 1.3612, loss_avg: ('1.5241',), lr: 0.000098, contrastive: 1.3612, 
Iteration 1901/3542 took 0.2822 s, ETA: 470.11 s, loss: 1.2114, loss_avg: ('1.5209',), lr: 0.000098, contrastive: 1.2114, 
Iteration 1951/3542 took 0.2517 s, ETA: 455.45 s, loss: 1.3399, loss_avg: ('1.5174',), lr: 0.000098, contrastive: 1.3399, 
Iteration 2001/3542 took 0.2606 s, ETA: 440.81 s, loss: 1.2789, loss_avg: ('1.5137',), lr: 0.000098, contrastive: 1.2789, 
Iteration 2051/3542 took 0.2508 s, ETA: 425.88 s, loss: 1.3485, loss_avg: ('1.5107',), lr: 0.000098, contrastive: 1.3485, 
Iteration 2101/3542 took 0.5065 s, ETA: 411.20 s, loss: 1.3287, loss_avg: ('1.5078',), lr: 0.000098, contrastive: 1.3287, 
Iteration 2151/3542 took 0.2945 s, ETA: 397.11 s, loss: 1.4385, loss_avg: ('1.5056',), lr: 0.000097, contrastive: 1.4385, 
Iteration 2201/3542 took 0.2634 s, ETA: 382.60 s, loss: 1.2927, loss_avg: ('1.5026',), lr: 0.000097, contrastive: 1.2927, 
Iteration 2251/3542 took 0.2715 s, ETA: 367.83 s, loss: 1.3845, loss_avg: ('1.5000',), lr: 0.000097, contrastive: 1.3845, 
Iteration 2301/3542 took 0.2719 s, ETA: 353.34 s, loss: 1.3460, loss_avg: ('1.4972',), lr: 0.000097, contrastive: 1.3460, 
Iteration 2351/3542 took 0.2974 s, ETA: 339.08 s, loss: 1.3561, loss_avg: ('1.4944',), lr: 0.000097, contrastive: 1.3561, 
Iteration 2401/3542 took 0.2944 s, ETA: 324.20 s, loss: 1.2993, loss_avg: ('1.4922',), lr: 0.000097, contrastive: 1.2993, 
Iteration 2451/3542 took 0.2866 s, ETA: 309.75 s, loss: 1.5381, loss_avg: ('1.4897',), lr: 0.000097, contrastive: 1.5381, 
Iteration 2501/3542 took 0.2358 s, ETA: 295.24 s, loss: 1.2482, loss_avg: ('1.4868',), lr: 0.000096, contrastive: 1.2482, 
Iteration 2551/3542 took 0.2732 s, ETA: 280.73 s, loss: 1.1466, loss_avg: ('1.4843',), lr: 0.000096, contrastive: 1.1466, 
Iteration 2601/3542 took 0.2788 s, ETA: 266.39 s, loss: 1.4275, loss_avg: ('1.4817',), lr: 0.000096, contrastive: 1.4275, 
Iteration 2651/3542 took 0.2704 s, ETA: 252.04 s, loss: 1.2783, loss_avg: ('1.4795',), lr: 0.000096, contrastive: 1.2783, 
Iteration 2701/3542 took 0.2849 s, ETA: 237.54 s, loss: 1.3104, loss_avg: ('1.4775',), lr: 0.000096, contrastive: 1.3104, 
Iteration 2751/3542 took 0.2173 s, ETA: 222.94 s, loss: 1.3578, loss_avg: ('1.4758',), lr: 0.000095, contrastive: 1.3578, 
Iteration 2801/3542 took 0.2608 s, ETA: 208.74 s, loss: 1.3260, loss_avg: ('1.4740',), lr: 0.000095, contrastive: 1.3260, 
Iteration 2851/3542 took 0.2905 s, ETA: 194.57 s, loss: 1.3549, loss_avg: ('1.4719',), lr: 0.000095, contrastive: 1.3549, 
Iteration 2901/3542 took 0.2681 s, ETA: 180.35 s, loss: 1.5047, loss_avg: ('1.4695',), lr: 0.000095, contrastive: 1.5047, 
Iteration 2951/3542 took 0.2684 s, ETA: 166.14 s, loss: 1.3474, loss_avg: ('1.4680',), lr: 0.000095, contrastive: 1.3474, 
Iteration 3001/3542 took 0.2565 s, ETA: 151.86 s, loss: 1.3266, loss_avg: ('1.4662',), lr: 0.000095, contrastive: 1.3266, 
Iteration 3051/3542 took 0.2289 s, ETA: 137.75 s, loss: 1.6077, loss_avg: ('1.4643',), lr: 0.000094, contrastive: 1.6077, 
Iteration 3101/3542 took 0.2937 s, ETA: 123.63 s, loss: 1.2984, loss_avg: ('1.4621',), lr: 0.000094, contrastive: 1.2984, 
Iteration 3151/3542 took 0.2536 s, ETA: 109.54 s, loss: 1.5509, loss_avg: ('1.4600',), lr: 0.000094, contrastive: 1.5509, 
Iteration 3201/3542 took 0.2707 s, ETA: 95.49 s, loss: 1.3693, loss_avg: ('1.4580',), lr: 0.000094, contrastive: 1.3693, 
Iteration 3251/3542 took 0.2770 s, ETA: 81.49 s, loss: 1.3233, loss_avg: ('1.4562',), lr: 0.000093, contrastive: 1.3233, 
Iteration 3301/3542 took 0.2670 s, ETA: 67.47 s, loss: 1.1966, loss_avg: ('1.4540',), lr: 0.000093, contrastive: 1.1966, 
Iteration 3351/3542 took 0.2908 s, ETA: 53.48 s, loss: 1.3651, loss_avg: ('1.4522',), lr: 0.000093, contrastive: 1.3651, 
Iteration 3401/3542 took 0.2716 s, ETA: 39.47 s, loss: 1.3660, loss_avg: ('1.4500',), lr: 0.000093, contrastive: 1.3660, 
Iteration 3451/3542 took 0.2360 s, ETA: 25.44 s, loss: 1.2834, loss_avg: ('1.4482',), lr: 0.000093, contrastive: 1.2834, 
Iteration 3501/3542 took 0.2467 s, ETA: 11.46 s, loss: 1.2088, loss_avg: ('1.4462',), lr: 0.000092, contrastive: 1.2088, 
Epoch: 1, Train Loss = 1.445, Lr = 0.000092

------------------------------[Evaluate]------------------------------
Extract Features and Compute Scores:
Recall@1: 53.8216 - Recall@5: 78.2618 - Recall@10: 83.3793 - Recall@top1: 94.6068 - AP: 64.2765 - SDM@1: 0.7736 - SDM@3: 0.7053 - SDM@5: 0.6593 - Dis@1: 479.2085 - Dis@3: 691.0004 - Dis@5: 825.5360

------------------------------[Epoch: 2]------------------------------

Shuffle Dataset:
Original Length: 71686 - Length after Shuffle: 70800
Break Counter: 16384
Pairs left out of last batch to avoid creating noise: 886
First Element: /data3/czh_code/gta/GTA-UAV-LR/drone/images/600_0001_0000033550.png - Last Element: /data3/czh_code/gta/GTA-UAV-LR/drone/images/500_0001_0000023746.png
First Element: /data3/czh_code/gta/GTA-UAV-LR/satellite/4_0_1_9.png - Last Element: /data3/czh_code/gta/GTA-UAV-LR/satellite/5_0_7_22.png
Iteration 1/3540 took 0.3277 s, ETA: 4558.40 s, loss: 1.3133, loss_avg: ('1.3133',), lr: 0.000092, contrastive: 1.3133, 
Iteration 51/3540 took 0.2502 s, ETA: 1027.72 s, loss: 1.3108, loss_avg: ('1.3177',), lr: 0.000092, contrastive: 1.3108, 
Iteration 101/3540 took 0.2651 s, ETA: 986.76 s, loss: 1.2689, loss_avg: ('1.3314',), lr: 0.000092, contrastive: 1.2689, 
Iteration 151/3540 took 0.2337 s, ETA: 948.86 s, loss: 1.3765, loss_avg: ('1.3308',), lr: 0.000091, contrastive: 1.3765, 
Iteration 201/3540 took 0.2671 s, ETA: 934.47 s, loss: 1.1862, loss_avg: ('1.3361',), lr: 0.000091, contrastive: 1.1862, 
Iteration 251/3540 took 0.2840 s, ETA: 916.70 s, loss: 1.5219, loss_avg: ('1.3372',), lr: 0.000091, contrastive: 1.5219, 
Iteration 301/3540 took 0.2686 s, ETA: 902.94 s, loss: 1.1987, loss_avg: ('1.3348',), lr: 0.000091, contrastive: 1.1987, 
Iteration 351/3540 took 0.2406 s, ETA: 884.56 s, loss: 1.2532, loss_avg: ('1.3381',), lr: 0.000090, contrastive: 1.2532, 
Iteration 401/3540 took 0.2642 s, ETA: 870.45 s, loss: 1.3163, loss_avg: ('1.3404',), lr: 0.000090, contrastive: 1.3163, 
Iteration 451/3540 took 0.2872 s, ETA: 857.78 s, loss: 1.3732, loss_avg: ('1.3407',), lr: 0.000090, contrastive: 1.3732, 
Iteration 501/3540 took 0.2296 s, ETA: 839.09 s, loss: 1.2592, loss_avg: ('1.3402',), lr: 0.000090, contrastive: 1.2592, 
Iteration 551/3540 took 0.2771 s, ETA: 823.14 s, loss: 1.4591, loss_avg: ('1.3419',), lr: 0.000089, contrastive: 1.4591, 
Iteration 601/3540 took 0.2705 s, ETA: 807.59 s, loss: 1.2287, loss_avg: ('1.3423',), lr: 0.000089, contrastive: 1.2287, 
Iteration 651/3540 took 0.2547 s, ETA: 793.39 s, loss: 1.2564, loss_avg: ('1.3414',), lr: 0.000089, contrastive: 1.2564, 
Iteration 701/3540 took 0.2659 s, ETA: 782.57 s, loss: 1.3212, loss_avg: ('1.3410',), lr: 0.000088, contrastive: 1.3212, 
Iteration 751/3540 took 0.2646 s, ETA: 767.78 s, loss: 1.3405, loss_avg: ('1.3397',), lr: 0.000088, contrastive: 1.3405, 
Iteration 801/3540 took 0.2631 s, ETA: 755.15 s, loss: 1.3753, loss_avg: ('1.3404',), lr: 0.000088, contrastive: 1.3753, 
Iteration 851/3540 took 0.2729 s, ETA: 740.76 s, loss: 1.1204, loss_avg: ('1.3388',), lr: 0.000088, contrastive: 1.1204, 
Iteration 901/3540 took 0.2791 s, ETA: 726.96 s, loss: 1.3011, loss_avg: ('1.3373',), lr: 0.000087, contrastive: 1.3011, 
Iteration 951/3540 took 0.2821 s, ETA: 714.75 s, loss: 1.3188, loss_avg: ('1.3373',), lr: 0.000087, contrastive: 1.3188, 
Iteration 1001/3540 took 0.2677 s, ETA: 700.48 s, loss: 1.3579, loss_avg: ('1.3374',), lr: 0.000087, contrastive: 1.3579, 
Iteration 1051/3540 took 0.2780 s, ETA: 686.53 s, loss: 1.3677, loss_avg: ('1.3374',), lr: 0.000086, contrastive: 1.3677, 
Iteration 1101/3540 took 0.2728 s, ETA: 672.20 s, loss: 1.5264, loss_avg: ('1.3383',), lr: 0.000086, contrastive: 1.5264, 
Iteration 1151/3540 took 0.2424 s, ETA: 660.55 s, loss: 1.2253, loss_avg: ('1.3375',), lr: 0.000086, contrastive: 1.2253, 
Iteration 1201/3540 took 0.2958 s, ETA: 646.43 s, loss: 1.4039, loss_avg: ('1.3363',), lr: 0.000085, contrastive: 1.4039, 
Iteration 1251/3540 took 0.2798 s, ETA: 632.84 s, loss: 1.2929, loss_avg: ('1.3360',), lr: 0.000085, contrastive: 1.2929, 
Iteration 1301/3540 took 0.2361 s, ETA: 619.56 s, loss: 1.2801, loss_avg: ('1.3364',), lr: 0.000085, contrastive: 1.2801, 
Iteration 1351/3540 took 0.2301 s, ETA: 604.07 s, loss: 1.4998, loss_avg: ('1.3368',), lr: 0.000084, contrastive: 1.4998, 
Iteration 1401/3540 took 0.2682 s, ETA: 589.05 s, loss: 1.4804, loss_avg: ('1.3366',), lr: 0.000084, contrastive: 1.4804, 
Iteration 1451/3540 took 0.2425 s, ETA: 576.26 s, loss: 1.3151, loss_avg: ('1.3359',), lr: 0.000084, contrastive: 1.3151, 
Iteration 1501/3540 took 0.2964 s, ETA: 561.93 s, loss: 1.3484, loss_avg: ('1.3356',), lr: 0.000083, contrastive: 1.3484, 
Iteration 1551/3540 took 0.2518 s, ETA: 548.22 s, loss: 1.1436, loss_avg: ('1.3349',), lr: 0.000083, contrastive: 1.1436, 
Iteration 1601/3540 took 0.3198 s, ETA: 534.20 s, loss: 1.3352, loss_avg: ('1.3347',), lr: 0.000083, contrastive: 1.3352, 
Iteration 1651/3540 took 0.2716 s, ETA: 519.84 s, loss: 1.3265, loss_avg: ('1.3343',), lr: 0.000082, contrastive: 1.3265, 
Iteration 1701/3540 took 0.2604 s, ETA: 505.43 s, loss: 1.3786, loss_avg: ('1.3347',), lr: 0.000082, contrastive: 1.3786, 
Iteration 1751/3540 took 0.2491 s, ETA: 491.07 s, loss: 1.2680, loss_avg: ('1.3340',), lr: 0.000082, contrastive: 1.2680, 
Iteration 1801/3540 took 0.2779 s, ETA: 477.49 s, loss: 1.3416, loss_avg: ('1.3342',), lr: 0.000081, contrastive: 1.3416, 
Iteration 1851/3540 took 0.3015 s, ETA: 463.95 s, loss: 1.3596, loss_avg: ('1.3339',), lr: 0.000081, contrastive: 1.3596, 
Iteration 1901/3540 took 0.2872 s, ETA: 450.02 s, loss: 1.2664, loss_avg: ('1.3329',), lr: 0.000081, contrastive: 1.2664, 
Iteration 1951/3540 took 0.2743 s, ETA: 436.09 s, loss: 1.4166, loss_avg: ('1.3331',), lr: 0.000080, contrastive: 1.4166, 
Iteration 2001/3540 took 0.2860 s, ETA: 422.58 s, loss: 1.4230, loss_avg: ('1.3329',), lr: 0.000080, contrastive: 1.4230, 
Iteration 2051/3540 took 0.2725 s, ETA: 409.18 s, loss: 1.3812, loss_avg: ('1.3325',), lr: 0.000080, contrastive: 1.3812, 
Iteration 2101/3540 took 0.2946 s, ETA: 395.83 s, loss: 1.2815, loss_avg: ('1.3325',), lr: 0.000079, contrastive: 1.2815, 
Iteration 2151/3540 took 0.3055 s, ETA: 382.60 s, loss: 1.3717, loss_avg: ('1.3319',), lr: 0.000079, contrastive: 1.3717, 
Iteration 2201/3540 took 0.2731 s, ETA: 368.83 s, loss: 1.3302, loss_avg: ('1.3313',), lr: 0.000079, contrastive: 1.3302, 
Iteration 2251/3540 took 0.2843 s, ETA: 355.35 s, loss: 1.1721, loss_avg: ('1.3314',), lr: 0.000078, contrastive: 1.1721, 
Iteration 2301/3540 took 0.2340 s, ETA: 341.15 s, loss: 1.3851, loss_avg: ('1.3312',), lr: 0.000078, contrastive: 1.3851, 
Iteration 2351/3540 took 0.2910 s, ETA: 326.96 s, loss: 1.5673, loss_avg: ('1.3305',), lr: 0.000077, contrastive: 1.5673, 
Iteration 2401/3540 took 0.2675 s, ETA: 313.31 s, loss: 1.1608, loss_avg: ('1.3303',), lr: 0.000077, contrastive: 1.1608, 
Iteration 2451/3540 took 0.2902 s, ETA: 299.73 s, loss: 1.2568, loss_avg: ('1.3304',), lr: 0.000077, contrastive: 1.2568, 
Iteration 2501/3540 took 0.2826 s, ETA: 286.08 s, loss: 1.3338, loss_avg: ('1.3300',), lr: 0.000076, contrastive: 1.3338, 
Iteration 2551/3540 took 0.2695 s, ETA: 272.39 s, loss: 1.2650, loss_avg: ('1.3300',), lr: 0.000076, contrastive: 1.2650, 
Iteration 2601/3540 took 0.2690 s, ETA: 258.89 s, loss: 1.3128, loss_avg: ('1.3295',), lr: 0.000076, contrastive: 1.3128, 
Iteration 2651/3540 took 0.3663 s, ETA: 245.06 s, loss: 1.3314, loss_avg: ('1.3291',), lr: 0.000075, contrastive: 1.3314, 
Iteration 2701/3540 took 0.2614 s, ETA: 231.21 s, loss: 1.3420, loss_avg: ('1.3286',), lr: 0.000075, contrastive: 1.3420, 
Iteration 2751/3540 took 0.2842 s, ETA: 217.72 s, loss: 1.5060, loss_avg: ('1.3282',), lr: 0.000074, contrastive: 1.5060, 
Iteration 2801/3540 took 0.2599 s, ETA: 203.90 s, loss: 1.4431, loss_avg: ('1.3277',), lr: 0.000074, contrastive: 1.4431, 
Iteration 2851/3540 took 0.2329 s, ETA: 189.77 s, loss: 1.5242, loss_avg: ('1.3273',), lr: 0.000074, contrastive: 1.5242, 
Iteration 2901/3540 took 0.2628 s, ETA: 175.90 s, loss: 1.2963, loss_avg: ('1.3271',), lr: 0.000073, contrastive: 1.2963, 
Iteration 2951/3540 took 0.2763 s, ETA: 162.09 s, loss: 1.4868, loss_avg: ('1.3272',), lr: 0.000073, contrastive: 1.4868, 
Iteration 3001/3540 took 0.3690 s, ETA: 148.37 s, loss: 1.3223, loss_avg: ('1.3273',), lr: 0.000072, contrastive: 1.3223, 
Iteration 3051/3540 took 0.2616 s, ETA: 134.68 s, loss: 1.3249, loss_avg: ('1.3268',), lr: 0.000072, contrastive: 1.3249, 
Iteration 3101/3540 took 0.2864 s, ETA: 120.85 s, loss: 1.2463, loss_avg: ('1.3267',), lr: 0.000072, contrastive: 1.2463, 
Iteration 3151/3540 took 0.2647 s, ETA: 107.17 s, loss: 1.1410, loss_avg: ('1.3262',), lr: 0.000071, contrastive: 1.1410, 
Iteration 3201/3540 took 0.2658 s, ETA: 93.38 s, loss: 1.3569, loss_avg: ('1.3259',), lr: 0.000071, contrastive: 1.3569, 
Iteration 3251/3540 took 0.2687 s, ETA: 79.62 s, loss: 1.1348, loss_avg: ('1.3254',), lr: 0.000070, contrastive: 1.1348, 
Iteration 3301/3540 took 0.2655 s, ETA: 65.84 s, loss: 1.2888, loss_avg: ('1.3248',), lr: 0.000070, contrastive: 1.2888, 
Iteration 3351/3540 took 0.2724 s, ETA: 52.03 s, loss: 1.3126, loss_avg: ('1.3241',), lr: 0.000070, contrastive: 1.3126, 
Iteration 3401/3540 took 0.2665 s, ETA: 38.27 s, loss: 1.1743, loss_avg: ('1.3235',), lr: 0.000069, contrastive: 1.1743, 
Iteration 3451/3540 took 0.2842 s, ETA: 24.50 s, loss: 1.2117, loss_avg: ('1.3229',), lr: 0.000069, contrastive: 1.2117, 
Iteration 3501/3540 took 0.2841 s, ETA: 10.74 s, loss: 1.3266, loss_avg: ('1.3224',), lr: 0.000068, contrastive: 1.3266, 
Epoch: 2, Train Loss = 1.322, Lr = 0.000068

------------------------------[Evaluate]------------------------------
Extract Features and Compute Scores:
Recall@1: 55.8950 - Recall@5: 81.1845 - Recall@10: 85.7836 - Recall@top1: 95.7097 - AP: 66.4776 - SDM@1: 0.7899 - SDM@3: 0.7200 - SDM@5: 0.6752 - Dis@1: 407.9191 - Dis@3: 616.1074 - Dis@5: 738.7411

------------------------------[Epoch: 3]------------------------------

Shuffle Dataset:
Original Length: 71686 - Length after Shuffle: 70760
Break Counter: 16384
Pairs left out of last batch to avoid creating noise: 926
First Element: /data3/czh_code/gta/GTA-UAV-LR/drone/images/100_0001_0000001686.png - Last Element: /data3/czh_code/gta/GTA-UAV-LR/drone/images/400_0001_0000017226.png
First Element: /data3/czh_code/gta/GTA-UAV-LR/satellite/6_0_18_48.png - Last Element: /data3/czh_code/gta/GTA-UAV-LR/satellite/4_0_2_11.png
Iteration 1/3538 took 0.2889 s, ETA: 3983.45 s, loss: 1.3819, loss_avg: ('1.3819',), lr: 0.000068, contrastive: 1.3819, 
Iteration 51/3538 took 0.2673 s, ETA: 1043.29 s, loss: 1.2252, loss_avg: ('1.3098',), lr: 0.000068, contrastive: 1.2252, 
Iteration 101/3538 took 0.2425 s, ETA: 981.68 s, loss: 1.3017, loss_avg: ('1.2988',), lr: 0.000067, contrastive: 1.3017, 
Iteration 151/3538 took 0.2839 s, ETA: 978.98 s, loss: 1.2312, loss_avg: ('1.2887',), lr: 0.000067, contrastive: 1.2312, 
Iteration 201/3538 took 0.2737 s, ETA: 951.43 s, loss: 1.2182, loss_avg: ('1.2871',), lr: 0.000066, contrastive: 1.2182, 
Iteration 251/3538 took 0.2552 s, ETA: 934.17 s, loss: 1.2957, loss_avg: ('1.2866',), lr: 0.000066, contrastive: 1.2957, 
Iteration 301/3538 took 0.2749 s, ETA: 915.33 s, loss: 1.1776, loss_avg: ('1.2878',), lr: 0.000065, contrastive: 1.1776, 
Iteration 351/3538 took 0.2771 s, ETA: 895.13 s, loss: 1.2470, loss_avg: ('1.2902',), lr: 0.000065, contrastive: 1.2470, 
Iteration 401/3538 took 0.2545 s, ETA: 878.74 s, loss: 1.2396, loss_avg: ('1.2913',), lr: 0.000065, contrastive: 1.2396, 
Iteration 451/3538 took 0.2455 s, ETA: 863.50 s, loss: 1.2608, loss_avg: ('1.2909',), lr: 0.000064, contrastive: 1.2608, 
Iteration 501/3538 took 0.3048 s, ETA: 849.85 s, loss: 1.3118, loss_avg: ('1.2906',), lr: 0.000064, contrastive: 1.3118, 
Iteration 551/3538 took 0.2839 s, ETA: 838.39 s, loss: 1.2116, loss_avg: ('1.2890',), lr: 0.000063, contrastive: 1.2116, 
Iteration 601/3538 took 0.2526 s, ETA: 823.32 s, loss: 1.2206, loss_avg: ('1.2902',), lr: 0.000063, contrastive: 1.2206, 
Iteration 651/3538 took 0.2972 s, ETA: 814.46 s, loss: 1.1682, loss_avg: ('1.2902',), lr: 0.000062, contrastive: 1.1682, 
Iteration 701/3538 took 0.2390 s, ETA: 797.51 s, loss: 1.2092, loss_avg: ('1.2915',), lr: 0.000062, contrastive: 1.2092, 
Iteration 751/3538 took 0.2515 s, ETA: 779.27 s, loss: 1.2865, loss_avg: ('1.2916',), lr: 0.000062, contrastive: 1.2865, 
Iteration 801/3538 took 0.2726 s, ETA: 766.04 s, loss: 1.1909, loss_avg: ('1.2909',), lr: 0.000061, contrastive: 1.1909, 
Iteration 851/3538 took 0.2829 s, ETA: 751.54 s, loss: 1.0514, loss_avg: ('1.2900',), lr: 0.000061, contrastive: 1.0514, 
Iteration 901/3538 took 0.2602 s, ETA: 735.72 s, loss: 1.1692, loss_avg: ('1.2906',), lr: 0.000060, contrastive: 1.1692, 
Iteration 951/3538 took 0.2705 s, ETA: 721.07 s, loss: 1.3281, loss_avg: ('1.2901',), lr: 0.000060, contrastive: 1.3281, 
Iteration 1001/3538 took 0.2760 s, ETA: 706.12 s, loss: 1.3739, loss_avg: ('1.2908',), lr: 0.000059, contrastive: 1.3739, 
Iteration 1051/3538 took 0.2765 s, ETA: 693.24 s, loss: 1.1777, loss_avg: ('1.2910',), lr: 0.000059, contrastive: 1.1777, 
Iteration 1101/3538 took 0.2798 s, ETA: 678.63 s, loss: 1.3027, loss_avg: ('1.2894',), lr: 0.000059, contrastive: 1.3027, 
Iteration 1151/3538 took 0.2686 s, ETA: 664.87 s, loss: 1.2910, loss_avg: ('1.2895',), lr: 0.000058, contrastive: 1.2910, 
Iteration 1201/3538 took 0.2730 s, ETA: 651.03 s, loss: 1.3523, loss_avg: ('1.2892',), lr: 0.000058, contrastive: 1.3523, 
Iteration 1251/3538 took 0.3076 s, ETA: 636.65 s, loss: 1.2318, loss_avg: ('1.2888',), lr: 0.000057, contrastive: 1.2318, 
Iteration 1301/3538 took 0.2559 s, ETA: 621.48 s, loss: 1.1372, loss_avg: ('1.2887',), lr: 0.000057, contrastive: 1.1372, 
Iteration 1351/3538 took 0.2433 s, ETA: 606.53 s, loss: 1.2872, loss_avg: ('1.2890',), lr: 0.000056, contrastive: 1.2872, 
Iteration 1401/3538 took 0.2899 s, ETA: 591.70 s, loss: 1.2414, loss_avg: ('1.2898',), lr: 0.000056, contrastive: 1.2414, 
Iteration 1451/3538 took 0.2850 s, ETA: 577.43 s, loss: 1.2635, loss_avg: ('1.2900',), lr: 0.000055, contrastive: 1.2635, 
Iteration 1501/3538 took 0.3126 s, ETA: 563.52 s, loss: 1.3918, loss_avg: ('1.2899',), lr: 0.000055, contrastive: 1.3918, 
Iteration 1551/3538 took 0.2495 s, ETA: 550.26 s, loss: 1.2813, loss_avg: ('1.2885',), lr: 0.000055, contrastive: 1.2813, 
Iteration 1601/3538 took 0.2750 s, ETA: 535.65 s, loss: 1.3759, loss_avg: ('1.2883',), lr: 0.000054, contrastive: 1.3759, 
Iteration 1651/3538 took 0.2297 s, ETA: 521.07 s, loss: 1.2068, loss_avg: ('1.2881',), lr: 0.000054, contrastive: 1.2068, 
Iteration 1701/3538 took 0.2599 s, ETA: 506.70 s, loss: 1.4011, loss_avg: ('1.2876',), lr: 0.000053, contrastive: 1.4011, 
Iteration 1751/3538 took 0.2702 s, ETA: 492.42 s, loss: 1.4635, loss_avg: ('1.2871',), lr: 0.000053, contrastive: 1.4635, 
Iteration 1801/3538 took 0.2775 s, ETA: 478.16 s, loss: 1.2026, loss_avg: ('1.2867',), lr: 0.000052, contrastive: 1.2026, 
Iteration 1851/3538 took 0.2983 s, ETA: 464.39 s, loss: 1.2810, loss_avg: ('1.2875',), lr: 0.000052, contrastive: 1.2810, 
Iteration 1901/3538 took 0.2670 s, ETA: 450.72 s, loss: 1.4114, loss_avg: ('1.2876',), lr: 0.000051, contrastive: 1.4114, 
Iteration 1951/3538 took 0.2766 s, ETA: 436.81 s, loss: 1.2414, loss_avg: ('1.2873',), lr: 0.000051, contrastive: 1.2414, 
Iteration 2001/3538 took 0.2807 s, ETA: 423.04 s, loss: 1.1806, loss_avg: ('1.2867',), lr: 0.000051, contrastive: 1.1806, 
Iteration 2051/3538 took 0.2623 s, ETA: 409.37 s, loss: 1.2851, loss_avg: ('1.2866',), lr: 0.000050, contrastive: 1.2851, 
Iteration 2101/3538 took 0.2829 s, ETA: 395.52 s, loss: 1.4639, loss_avg: ('1.2867',), lr: 0.000050, contrastive: 1.4639, 
Iteration 2151/3538 took 0.2872 s, ETA: 382.03 s, loss: 1.1219, loss_avg: ('1.2868',), lr: 0.000049, contrastive: 1.1219, 
Iteration 2201/3538 took 0.2735 s, ETA: 368.03 s, loss: 1.2666, loss_avg: ('1.2868',), lr: 0.000049, contrastive: 1.2666, 
Iteration 2251/3538 took 0.3335 s, ETA: 354.31 s, loss: 1.2470, loss_avg: ('1.2867',), lr: 0.000048, contrastive: 1.2470, 
Iteration 2301/3538 took 0.2461 s, ETA: 340.55 s, loss: 1.1953, loss_avg: ('1.2862',), lr: 0.000048, contrastive: 1.1953, 
Iteration 2351/3538 took 0.2747 s, ETA: 326.77 s, loss: 1.4070, loss_avg: ('1.2859',), lr: 0.000047, contrastive: 1.4070, 
Iteration 2401/3538 took 0.2651 s, ETA: 312.92 s, loss: 1.1213, loss_avg: ('1.2858',), lr: 0.000047, contrastive: 1.1213, 
Iteration 2451/3538 took 0.2272 s, ETA: 299.36 s, loss: 1.1589, loss_avg: ('1.2856',), lr: 0.000047, contrastive: 1.1589, 
Iteration 2501/3538 took 0.2777 s, ETA: 285.57 s, loss: 1.3334, loss_avg: ('1.2857',), lr: 0.000046, contrastive: 1.3334, 
Iteration 2551/3538 took 0.2674 s, ETA: 271.64 s, loss: 1.2177, loss_avg: ('1.2860',), lr: 0.000046, contrastive: 1.2177, 
Iteration 2601/3538 took 0.3019 s, ETA: 257.81 s, loss: 1.3257, loss_avg: ('1.2857',), lr: 0.000045, contrastive: 1.3257, 
Iteration 2651/3538 took 0.2917 s, ETA: 244.05 s, loss: 1.0619, loss_avg: ('1.2852',), lr: 0.000045, contrastive: 1.0619, 
Iteration 2701/3538 took 0.2202 s, ETA: 230.21 s, loss: 1.2988, loss_avg: ('1.2847',), lr: 0.000044, contrastive: 1.2988, 
Iteration 2751/3538 took 0.3515 s, ETA: 216.41 s, loss: 1.3164, loss_avg: ('1.2848',), lr: 0.000044, contrastive: 1.3164, 
Iteration 2801/3538 took 0.2452 s, ETA: 202.52 s, loss: 1.1669, loss_avg: ('1.2848',), lr: 0.000043, contrastive: 1.1669, 
Iteration 2851/3538 took 0.2768 s, ETA: 188.72 s, loss: 1.2653, loss_avg: ('1.2850',), lr: 0.000043, contrastive: 1.2653, 
Iteration 2901/3538 took 0.2522 s, ETA: 175.02 s, loss: 1.2672, loss_avg: ('1.2848',), lr: 0.000043, contrastive: 1.2672, 
Iteration 2951/3538 took 0.2847 s, ETA: 161.32 s, loss: 1.2749, loss_avg: ('1.2845',), lr: 0.000042, contrastive: 1.2749, 
Iteration 3001/3538 took 0.2578 s, ETA: 147.83 s, loss: 1.2741, loss_avg: ('1.2842',), lr: 0.000042, contrastive: 1.2741, 
Iteration 3051/3538 took 0.3148 s, ETA: 134.12 s, loss: 1.2884, loss_avg: ('1.2838',), lr: 0.000041, contrastive: 1.2884, 
Iteration 3101/3538 took 0.2741 s, ETA: 120.49 s, loss: 1.3693, loss_avg: ('1.2830',), lr: 0.000041, contrastive: 1.3693, 
Iteration 3151/3538 took 0.4585 s, ETA: 106.91 s, loss: 1.3091, loss_avg: ('1.2828',), lr: 0.000040, contrastive: 1.3091, 
Iteration 3201/3538 took 0.2787 s, ETA: 93.17 s, loss: 1.2786, loss_avg: ('1.2823',), lr: 0.000040, contrastive: 1.2786, 
Iteration 3251/3538 took 0.2460 s, ETA: 79.31 s, loss: 1.2270, loss_avg: ('1.2820',), lr: 0.000039, contrastive: 1.2270, 
Iteration 3301/3538 took 0.3150 s, ETA: 65.54 s, loss: 1.2719, loss_avg: ('1.2818',), lr: 0.000039, contrastive: 1.2719, 
Iteration 3351/3538 took 0.3105 s, ETA: 51.74 s, loss: 1.2633, loss_avg: ('1.2813',), lr: 0.000039, contrastive: 1.2633, 
Iteration 3401/3538 took 0.2986 s, ETA: 37.97 s, loss: 1.1833, loss_avg: ('1.2811',), lr: 0.000038, contrastive: 1.1833, 
Iteration 3451/3538 took 0.3494 s, ETA: 24.12 s, loss: 1.2406, loss_avg: ('1.2807',), lr: 0.000038, contrastive: 1.2406, 
Iteration 3501/3538 took 0.2790 s, ETA: 10.26 s, loss: 1.2700, loss_avg: ('1.2801',), lr: 0.000037, contrastive: 1.2700, 
Epoch: 3, Train Loss = 1.280, Lr = 0.000037

------------------------------[Evaluate]------------------------------
Extract Features and Compute Scores:
Recall@1: 56.6009 - Recall@5: 80.9860 - Recall@10: 86.1476 - Recall@top1: 96.4376 - AP: 67.0594 - SDM@1: 0.7941 - SDM@3: 0.7265 - SDM@5: 0.6804 - Dis@1: 402.7438 - Dis@3: 613.6421 - Dis@5: 744.9080

------------------------------[Epoch: 4]------------------------------

Shuffle Dataset:
Original Length: 71686 - Length after Shuffle: 70800
Break Counter: 16384
Pairs left out of last batch to avoid creating noise: 886
First Element: /data3/czh_code/gta/GTA-UAV-LR/drone/images/300_0001_0000011232.png - Last Element: /data3/czh_code/gta/GTA-UAV-LR/drone/images/200_0001_0000005706.png
First Element: /data3/czh_code/gta/GTA-UAV-LR/satellite/6_0_9_54.png - Last Element: /data3/czh_code/gta/GTA-UAV-LR/satellite/5_0_4_19.png
Iteration 1/3540 took 0.3401 s, ETA: 4865.09 s, loss: 1.4717, loss_avg: ('1.4717',), lr: 0.000037, contrastive: 1.4717, 
Iteration 51/3540 took 0.2413 s, ETA: 1048.99 s, loss: 1.4205, loss_avg: ('1.2584',), lr: 0.000036, contrastive: 1.4205, 
Iteration 101/3540 took 0.2899 s, ETA: 1021.37 s, loss: 1.3275, loss_avg: ('1.2571',), lr: 0.000036, contrastive: 1.3275, 
Iteration 151/3540 took 0.2462 s, ETA: 996.73 s, loss: 1.2577, loss_avg: ('1.2568',), lr: 0.000036, contrastive: 1.2577, 
Iteration 201/3540 took 0.2611 s, ETA: 963.09 s, loss: 1.2622, loss_avg: ('1.2595',), lr: 0.000035, contrastive: 1.2622, 
Iteration 251/3540 took 0.2899 s, ETA: 942.43 s, loss: 1.2297, loss_avg: ('1.2603',), lr: 0.000035, contrastive: 1.2297, 
Iteration 301/3540 took 0.2878 s, ETA: 935.78 s, loss: 1.3294, loss_avg: ('1.2607',), lr: 0.000034, contrastive: 1.3294, 
Iteration 351/3540 took 0.2805 s, ETA: 919.35 s, loss: 1.1793, loss_avg: ('1.2624',), lr: 0.000034, contrastive: 1.1793, 
Iteration 401/3540 took 0.3064 s, ETA: 905.45 s, loss: 1.2459, loss_avg: ('1.2627',), lr: 0.000034, contrastive: 1.2459, 
Iteration 451/3540 took 0.2847 s, ETA: 892.18 s, loss: 1.2504, loss_avg: ('1.2622',), lr: 0.000033, contrastive: 1.2504, 
Iteration 501/3540 took 0.2556 s, ETA: 876.50 s, loss: 1.2119, loss_avg: ('1.2618',), lr: 0.000033, contrastive: 1.2119, 
Iteration 551/3540 took 0.2941 s, ETA: 860.96 s, loss: 1.2334, loss_avg: ('1.2598',), lr: 0.000032, contrastive: 1.2334, 
Iteration 601/3540 took 0.2287 s, ETA: 845.71 s, loss: 1.2145, loss_avg: ('1.2593',), lr: 0.000032, contrastive: 1.2145, 
Iteration 651/3540 took 0.2861 s, ETA: 828.66 s, loss: 1.0879, loss_avg: ('1.2597',), lr: 0.000031, contrastive: 1.0879, 
Iteration 701/3540 took 0.2757 s, ETA: 813.13 s, loss: 1.1565, loss_avg: ('1.2595',), lr: 0.000031, contrastive: 1.1565, 
Iteration 751/3540 took 0.2432 s, ETA: 797.78 s, loss: 1.2681, loss_avg: ('1.2580',), lr: 0.000031, contrastive: 1.2681, 
Iteration 801/3540 took 0.2748 s, ETA: 782.71 s, loss: 1.1647, loss_avg: ('1.2577',), lr: 0.000030, contrastive: 1.1647, 
Iteration 851/3540 took 0.2836 s, ETA: 768.05 s, loss: 1.3768, loss_avg: ('1.2580',), lr: 0.000030, contrastive: 1.3768, 
Iteration 901/3540 took 0.3191 s, ETA: 755.32 s, loss: 1.2262, loss_avg: ('1.2572',), lr: 0.000029, contrastive: 1.2262, 
Iteration 951/3540 took 0.2885 s, ETA: 741.40 s, loss: 1.2347, loss_avg: ('1.2566',), lr: 0.000029, contrastive: 1.2347, 
Iteration 1001/3540 took 0.2820 s, ETA: 727.83 s, loss: 1.2835, loss_avg: ('1.2574',), lr: 0.000029, contrastive: 1.2835, 
Iteration 1051/3540 took 0.2616 s, ETA: 712.59 s, loss: 1.2682, loss_avg: ('1.2570',), lr: 0.000028, contrastive: 1.2682, 
Iteration 1101/3540 took 0.2791 s, ETA: 698.39 s, loss: 1.3054, loss_avg: ('1.2573',), lr: 0.000028, contrastive: 1.3054, 
Iteration 1151/3540 took 0.3054 s, ETA: 683.93 s, loss: 1.2810, loss_avg: ('1.2575',), lr: 0.000027, contrastive: 1.2810, 
Iteration 1201/3540 took 0.2767 s, ETA: 669.14 s, loss: 1.2731, loss_avg: ('1.2580',), lr: 0.000027, contrastive: 1.2731, 
Iteration 1251/3540 took 0.2871 s, ETA: 655.47 s, loss: 1.2840, loss_avg: ('1.2578',), lr: 0.000027, contrastive: 1.2840, 
Iteration 1301/3540 took 0.2836 s, ETA: 641.14 s, loss: 1.2813, loss_avg: ('1.2571',), lr: 0.000026, contrastive: 1.2813, 
Iteration 1351/3540 took 0.2901 s, ETA: 626.23 s, loss: 1.2745, loss_avg: ('1.2567',), lr: 0.000026, contrastive: 1.2745, 
Iteration 1401/3540 took 0.2909 s, ETA: 612.77 s, loss: 1.2551, loss_avg: ('1.2566',), lr: 0.000025, contrastive: 1.2551, 
Iteration 1451/3540 took 0.2938 s, ETA: 598.58 s, loss: 1.2045, loss_avg: ('1.2565',), lr: 0.000025, contrastive: 1.2045, 
Iteration 1501/3540 took 0.2929 s, ETA: 583.87 s, loss: 1.2464, loss_avg: ('1.2565',), lr: 0.000025, contrastive: 1.2464, 
Iteration 1551/3540 took 0.2801 s, ETA: 569.31 s, loss: 1.3039, loss_avg: ('1.2562',), lr: 0.000024, contrastive: 1.3039, 
Iteration 1601/3540 took 0.2816 s, ETA: 555.47 s, loss: 1.3269, loss_avg: ('1.2554',), lr: 0.000024, contrastive: 1.3269, 
Iteration 1651/3540 took 0.2520 s, ETA: 540.70 s, loss: 1.2612, loss_avg: ('1.2555',), lr: 0.000023, contrastive: 1.2612, 
Iteration 1701/3540 took 0.2520 s, ETA: 526.31 s, loss: 1.1596, loss_avg: ('1.2554',), lr: 0.000023, contrastive: 1.1596, 
Iteration 1751/3540 took 0.2886 s, ETA: 512.38 s, loss: 1.3221, loss_avg: ('1.2552',), lr: 0.000023, contrastive: 1.3221, 
Iteration 1801/3540 took 0.2889 s, ETA: 498.41 s, loss: 1.1478, loss_avg: ('1.2547',), lr: 0.000022, contrastive: 1.1478, 
Iteration 1851/3540 took 0.3208 s, ETA: 484.08 s, loss: 1.1739, loss_avg: ('1.2549',), lr: 0.000022, contrastive: 1.1739, 
Iteration 1901/3540 took 0.2817 s, ETA: 469.82 s, loss: 1.4438, loss_avg: ('1.2556',), lr: 0.000022, contrastive: 1.4438, 
Iteration 1951/3540 took 0.3201 s, ETA: 455.42 s, loss: 1.2396, loss_avg: ('1.2557',), lr: 0.000021, contrastive: 1.2396, 
Iteration 2001/3540 took 0.2748 s, ETA: 440.69 s, loss: 1.3025, loss_avg: ('1.2558',), lr: 0.000021, contrastive: 1.3025, 
Iteration 2051/3540 took 0.3111 s, ETA: 426.45 s, loss: 1.2610, loss_avg: ('1.2559',), lr: 0.000020, contrastive: 1.2610, 
Iteration 2101/3540 took 0.3212 s, ETA: 412.49 s, loss: 1.3489, loss_avg: ('1.2559',), lr: 0.000020, contrastive: 1.3489, 
Iteration 2151/3540 took 0.2995 s, ETA: 398.12 s, loss: 1.2044, loss_avg: ('1.2557',), lr: 0.000020, contrastive: 1.2044, 
Iteration 2201/3540 took 0.2974 s, ETA: 383.60 s, loss: 1.2862, loss_avg: ('1.2554',), lr: 0.000019, contrastive: 1.2862, 
Iteration 2251/3540 took 0.2951 s, ETA: 369.27 s, loss: 1.1174, loss_avg: ('1.2551',), lr: 0.000019, contrastive: 1.1174, 
Iteration 2301/3540 took 0.2829 s, ETA: 355.17 s, loss: 1.3366, loss_avg: ('1.2551',), lr: 0.000019, contrastive: 1.3366, 
Iteration 2351/3540 took 0.2974 s, ETA: 340.71 s, loss: 1.4034, loss_avg: ('1.2551',), lr: 0.000018, contrastive: 1.4034, 
Iteration 2401/3540 took 0.2573 s, ETA: 326.25 s, loss: 1.1646, loss_avg: ('1.2549',), lr: 0.000018, contrastive: 1.1646, 
Iteration 2451/3540 took 0.2995 s, ETA: 311.55 s, loss: 1.2172, loss_avg: ('1.2549',), lr: 0.000018, contrastive: 1.2172, 
Iteration 2501/3540 took 0.2602 s, ETA: 297.29 s, loss: 1.0772, loss_avg: ('1.2552',), lr: 0.000017, contrastive: 1.0772, 
Iteration 2551/3540 took 0.3066 s, ETA: 283.14 s, loss: 1.2550, loss_avg: ('1.2552',), lr: 0.000017, contrastive: 1.2550, 
Iteration 2601/3540 took 0.2951 s, ETA: 269.00 s, loss: 1.4085, loss_avg: ('1.2551',), lr: 0.000017, contrastive: 1.4085, 
Iteration 2651/3540 took 0.2888 s, ETA: 254.64 s, loss: 1.2518, loss_avg: ('1.2546',), lr: 0.000016, contrastive: 1.2518, 
Iteration 2701/3540 took 0.4947 s, ETA: 240.08 s, loss: 1.1991, loss_avg: ('1.2547',), lr: 0.000016, contrastive: 1.1991, 
Iteration 2751/3540 took 0.3162 s, ETA: 225.69 s, loss: 1.2722, loss_avg: ('1.2547',), lr: 0.000016, contrastive: 1.2722, 
Iteration 2801/3540 took 0.2997 s, ETA: 211.60 s, loss: 1.2559, loss_avg: ('1.2543',), lr: 0.000015, contrastive: 1.2559, 
Iteration 2851/3540 took 0.2861 s, ETA: 197.38 s, loss: 1.3023, loss_avg: ('1.2540',), lr: 0.000015, contrastive: 1.3023, 
Iteration 2901/3540 took 0.2585 s, ETA: 183.00 s, loss: 1.2052, loss_avg: ('1.2538',), lr: 0.000015, contrastive: 1.2052, 
Iteration 2951/3540 took 0.2871 s, ETA: 168.65 s, loss: 1.1218, loss_avg: ('1.2538',), lr: 0.000014, contrastive: 1.1218, 
Iteration 3001/3540 took 0.2625 s, ETA: 154.31 s, loss: 1.2152, loss_avg: ('1.2535',), lr: 0.000014, contrastive: 1.2152, 
Iteration 3051/3540 took 0.2482 s, ETA: 139.91 s, loss: 1.0905, loss_avg: ('1.2534',), lr: 0.000014, contrastive: 1.0905, 
Iteration 3101/3540 took 0.3111 s, ETA: 125.65 s, loss: 1.2393, loss_avg: ('1.2530',), lr: 0.000013, contrastive: 1.2393, 
Iteration 3151/3540 took 0.2782 s, ETA: 111.31 s, loss: 1.1806, loss_avg: ('1.2529',), lr: 0.000013, contrastive: 1.1806, 
Iteration 3201/3540 took 0.2816 s, ETA: 96.93 s, loss: 1.2683, loss_avg: ('1.2529',), lr: 0.000013, contrastive: 1.2683, 
Iteration 3251/3540 took 0.2935 s, ETA: 82.65 s, loss: 1.2268, loss_avg: ('1.2528',), lr: 0.000013, contrastive: 1.2268, 
Iteration 3301/3540 took 0.3103 s, ETA: 68.35 s, loss: 1.2463, loss_avg: ('1.2522',), lr: 0.000012, contrastive: 1.2463, 
Iteration 3351/3540 took 0.3045 s, ETA: 54.09 s, loss: 1.0683, loss_avg: ('1.2518',), lr: 0.000012, contrastive: 1.0683, 
Iteration 3401/3540 took 0.2964 s, ETA: 39.80 s, loss: 1.1728, loss_avg: ('1.2513',), lr: 0.000012, contrastive: 1.1728, 
Iteration 3451/3540 took 0.2544 s, ETA: 25.48 s, loss: 1.2982, loss_avg: ('1.2511',), lr: 0.000011, contrastive: 1.2982, 
Iteration 3501/3540 took 0.2395 s, ETA: 11.17 s, loss: 1.2472, loss_avg: ('1.2509',), lr: 0.000011, contrastive: 1.2472, 
Epoch: 4, Train Loss = 1.251, Lr = 0.000011

------------------------------[Evaluate]------------------------------
Extract Features and Compute Scores:
Recall@1: 57.4501 - Recall@5: 82.0448 - Recall@10: 87.1512 - Recall@top1: 95.8862 - AP: 67.9930 - SDM@1: 0.7972 - SDM@3: 0.7329 - SDM@5: 0.6864 - Dis@1: 401.8565 - Dis@3: 600.0489 - Dis@5: 739.0779

------------------------------[Epoch: 5]------------------------------

Shuffle Dataset:
Original Length: 71686 - Length after Shuffle: 70640
Break Counter: 16384
Pairs left out of last batch to avoid creating noise: 1046
First Element: /data3/czh_code/gta/GTA-UAV-LR/drone/images/600_0001_0000028993.png - Last Element: /data3/czh_code/gta/GTA-UAV-LR/drone/images/400_0001_0000017970.png
First Element: /data3/czh_code/gta/GTA-UAV-LR/satellite/5_0_6_20.png - Last Element: /data3/czh_code/gta/GTA-UAV-LR/satellite/6_0_14_47.png
Iteration 1/3532 took 0.2969 s, ETA: 4083.39 s, loss: 1.1771, loss_avg: ('1.1771',), lr: 0.000011, contrastive: 1.1771, 
Iteration 51/3532 took 0.2638 s, ETA: 1047.30 s, loss: 1.2599, loss_avg: ('1.2663',), lr: 0.000011, contrastive: 1.2599, 
Iteration 101/3532 took 0.2742 s, ETA: 1035.09 s, loss: 1.1978, loss_avg: ('1.2633',), lr: 0.000010, contrastive: 1.1978, 
Iteration 151/3532 took 0.2784 s, ETA: 1012.54 s, loss: 1.2679, loss_avg: ('1.2544',), lr: 0.000010, contrastive: 1.2679, 
Iteration 201/3532 took 0.3001 s, ETA: 984.70 s, loss: 1.3570, loss_avg: ('1.2480',), lr: 0.000010, contrastive: 1.3570, 
Iteration 251/3532 took 0.3115 s, ETA: 960.68 s, loss: 1.0356, loss_avg: ('1.2465',), lr: 0.000010, contrastive: 1.0356, 
Iteration 301/3532 took 0.2904 s, ETA: 939.01 s, loss: 1.1884, loss_avg: ('1.2439',), lr: 0.000009, contrastive: 1.1884, 
Iteration 351/3532 took 0.2727 s, ETA: 922.43 s, loss: 1.1442, loss_avg: ('1.2435',), lr: 0.000009, contrastive: 1.1442, 
Iteration 401/3532 took 0.2770 s, ETA: 905.80 s, loss: 1.2516, loss_avg: ('1.2411',), lr: 0.000009, contrastive: 1.2516, 
Iteration 451/3532 took 0.3605 s, ETA: 890.64 s, loss: 1.1213, loss_avg: ('1.2403',), lr: 0.000009, contrastive: 1.1213, 
Iteration 501/3532 took 0.2428 s, ETA: 874.14 s, loss: 1.2418, loss_avg: ('1.2391',), lr: 0.000008, contrastive: 1.2418, 
Iteration 551/3532 took 0.2825 s, ETA: 859.15 s, loss: 1.2101, loss_avg: ('1.2386',), lr: 0.000008, contrastive: 1.2101, 
Iteration 601/3532 took 0.2828 s, ETA: 841.00 s, loss: 1.2655, loss_avg: ('1.2402',), lr: 0.000008, contrastive: 1.2655, 
Iteration 651/3532 took 0.2652 s, ETA: 825.10 s, loss: 1.0693, loss_avg: ('1.2409',), lr: 0.000008, contrastive: 1.0693, 
Iteration 701/3532 took 0.2794 s, ETA: 808.48 s, loss: 1.1961, loss_avg: ('1.2393',), lr: 0.000007, contrastive: 1.1961, 
Iteration 751/3532 took 0.2648 s, ETA: 794.21 s, loss: 1.2158, loss_avg: ('1.2380',), lr: 0.000007, contrastive: 1.2158, 
Iteration 801/3532 took 0.2883 s, ETA: 781.22 s, loss: 1.1405, loss_avg: ('1.2381',), lr: 0.000007, contrastive: 1.1405, 
Iteration 851/3532 took 0.2545 s, ETA: 766.67 s, loss: 1.3965, loss_avg: ('1.2393',), lr: 0.000007, contrastive: 1.3965, 
Iteration 901/3532 took 0.2970 s, ETA: 753.16 s, loss: 1.2628, loss_avg: ('1.2398',), lr: 0.000006, contrastive: 1.2628, 
Iteration 951/3532 took 0.2789 s, ETA: 739.43 s, loss: 1.1739, loss_avg: ('1.2397',), lr: 0.000006, contrastive: 1.1739, 
Iteration 1001/3532 took 0.4102 s, ETA: 725.53 s, loss: 1.1154, loss_avg: ('1.2397',), lr: 0.000006, contrastive: 1.1154, 
Iteration 1051/3532 took 0.2619 s, ETA: 710.33 s, loss: 1.4079, loss_avg: ('1.2387',), lr: 0.000006, contrastive: 1.4079, 
Iteration 1101/3532 took 0.2641 s, ETA: 695.97 s, loss: 1.0484, loss_avg: ('1.2386',), lr: 0.000006, contrastive: 1.0484, 
Iteration 1151/3532 took 0.2522 s, ETA: 681.94 s, loss: 1.2583, loss_avg: ('1.2391',), lr: 0.000005, contrastive: 1.2583, 
Iteration 1201/3532 took 0.2938 s, ETA: 667.03 s, loss: 1.1643, loss_avg: ('1.2385',), lr: 0.000005, contrastive: 1.1643, 
Iteration 1251/3532 took 0.2838 s, ETA: 652.84 s, loss: 1.1022, loss_avg: ('1.2385',), lr: 0.000005, contrastive: 1.1022, 
Iteration 1301/3532 took 0.2853 s, ETA: 638.32 s, loss: 1.1244, loss_avg: ('1.2388',), lr: 0.000005, contrastive: 1.1244, 
Iteration 1351/3532 took 0.3709 s, ETA: 624.09 s, loss: 1.4127, loss_avg: ('1.2391',), lr: 0.000005, contrastive: 1.4127, 
Iteration 1401/3532 took 0.2668 s, ETA: 609.47 s, loss: 1.1883, loss_avg: ('1.2387',), lr: 0.000004, contrastive: 1.1883, 
Iteration 1451/3532 took 0.2994 s, ETA: 595.25 s, loss: 1.2221, loss_avg: ('1.2386',), lr: 0.000004, contrastive: 1.2221, 
Iteration 1501/3532 took 0.3105 s, ETA: 581.14 s, loss: 1.3141, loss_avg: ('1.2384',), lr: 0.000004, contrastive: 1.3141, 
Iteration 1551/3532 took 0.2894 s, ETA: 566.61 s, loss: 1.3199, loss_avg: ('1.2384',), lr: 0.000004, contrastive: 1.3199, 
Iteration 1601/3532 took 0.2769 s, ETA: 552.46 s, loss: 1.1215, loss_avg: ('1.2384',), lr: 0.000004, contrastive: 1.1215, 
Iteration 1651/3532 took 0.3611 s, ETA: 537.92 s, loss: 1.2038, loss_avg: ('1.2383',), lr: 0.000004, contrastive: 1.2038, 
Iteration 1701/3532 took 0.2695 s, ETA: 524.49 s, loss: 1.2451, loss_avg: ('1.2389',), lr: 0.000003, contrastive: 1.2451, 
Iteration 1751/3532 took 0.2655 s, ETA: 510.26 s, loss: 1.2948, loss_avg: ('1.2386',), lr: 0.000003, contrastive: 1.2948, 
Iteration 1801/3532 took 0.2893 s, ETA: 495.84 s, loss: 1.2218, loss_avg: ('1.2386',), lr: 0.000003, contrastive: 1.2218, 
Iteration 1851/3532 took 0.2755 s, ETA: 482.23 s, loss: 1.2738, loss_avg: ('1.2385',), lr: 0.000003, contrastive: 1.2738, 
Iteration 1901/3532 took 0.2953 s, ETA: 467.94 s, loss: 1.2222, loss_avg: ('1.2384',), lr: 0.000003, contrastive: 1.2222, 
Iteration 1951/3532 took 0.2770 s, ETA: 454.45 s, loss: 1.4774, loss_avg: ('1.2385',), lr: 0.000003, contrastive: 1.4774, 
Iteration 2001/3532 took 0.3330 s, ETA: 440.12 s, loss: 1.2753, loss_avg: ('1.2386',), lr: 0.000002, contrastive: 1.2753, 
Iteration 2051/3532 took 0.2661 s, ETA: 425.54 s, loss: 1.3544, loss_avg: ('1.2385',), lr: 0.000002, contrastive: 1.3544, 
Iteration 2101/3532 took 0.2620 s, ETA: 411.10 s, loss: 1.3144, loss_avg: ('1.2384',), lr: 0.000002, contrastive: 1.3144, 
Iteration 2151/3532 took 0.2917 s, ETA: 396.53 s, loss: 1.1553, loss_avg: ('1.2380',), lr: 0.000002, contrastive: 1.1553, 
Iteration 2201/3532 took 0.2458 s, ETA: 382.26 s, loss: 1.1686, loss_avg: ('1.2379',), lr: 0.000002, contrastive: 1.1686, 
Iteration 2251/3532 took 0.2821 s, ETA: 367.71 s, loss: 1.2787, loss_avg: ('1.2380',), lr: 0.000002, contrastive: 1.2787, 
Iteration 2301/3532 took 0.2555 s, ETA: 353.70 s, loss: 1.1139, loss_avg: ('1.2383',), lr: 0.000002, contrastive: 1.1139, 
Iteration 2351/3532 took 0.2822 s, ETA: 339.36 s, loss: 1.1579, loss_avg: ('1.2383',), lr: 0.000002, contrastive: 1.1579, 
Iteration 2401/3532 took 0.3055 s, ETA: 324.82 s, loss: 1.0858, loss_avg: ('1.2383',), lr: 0.000001, contrastive: 1.0858, 
Iteration 2451/3532 took 0.3173 s, ETA: 310.88 s, loss: 1.2411, loss_avg: ('1.2385',), lr: 0.000001, contrastive: 1.2411, 
Iteration 2501/3532 took 0.2930 s, ETA: 296.50 s, loss: 1.3028, loss_avg: ('1.2387',), lr: 0.000001, contrastive: 1.3028, 
Iteration 2551/3532 took 0.2707 s, ETA: 282.15 s, loss: 1.2599, loss_avg: ('1.2386',), lr: 0.000001, contrastive: 1.2599, 
Iteration 2601/3532 took 0.2947 s, ETA: 267.65 s, loss: 1.1858, loss_avg: ('1.2383',), lr: 0.000001, contrastive: 1.1858, 
Iteration 2651/3532 took 0.2814 s, ETA: 253.07 s, loss: 1.2112, loss_avg: ('1.2382',), lr: 0.000001, contrastive: 1.2112, 
Iteration 2701/3532 took 0.2927 s, ETA: 238.90 s, loss: 1.1805, loss_avg: ('1.2378',), lr: 0.000001, contrastive: 1.1805, 
Iteration 2751/3532 took 0.2730 s, ETA: 224.40 s, loss: 1.3187, loss_avg: ('1.2378',), lr: 0.000001, contrastive: 1.3187, 
Iteration 2801/3532 took 0.2950 s, ETA: 210.11 s, loss: 1.2276, loss_avg: ('1.2375',), lr: 0.000001, contrastive: 1.2276, 
Iteration 2851/3532 took 0.2846 s, ETA: 195.76 s, loss: 1.1194, loss_avg: ('1.2375',), lr: 0.000001, contrastive: 1.1194, 
Iteration 2901/3532 took 0.2834 s, ETA: 181.35 s, loss: 1.2092, loss_avg: ('1.2374',), lr: 0.000001, contrastive: 1.2092, 
Iteration 2951/3532 took 0.2983 s, ETA: 166.92 s, loss: 1.1235, loss_avg: ('1.2374',), lr: 0.000001, contrastive: 1.1235, 
Iteration 3001/3532 took 0.2849 s, ETA: 152.48 s, loss: 1.3746, loss_avg: ('1.2371',), lr: 0.000000, contrastive: 1.3746, 
Iteration 3051/3532 took 0.2365 s, ETA: 138.09 s, loss: 1.1786, loss_avg: ('1.2368',), lr: 0.000000, contrastive: 1.1786, 
Iteration 3101/3532 took 0.2769 s, ETA: 123.77 s, loss: 1.1702, loss_avg: ('1.2364',), lr: 0.000000, contrastive: 1.1702, 
Iteration 3151/3532 took 0.2715 s, ETA: 109.39 s, loss: 1.4369, loss_avg: ('1.2366',), lr: 0.000000, contrastive: 1.4369, 
Iteration 3201/3532 took 0.2870 s, ETA: 95.01 s, loss: 1.2649, loss_avg: ('1.2365',), lr: 0.000000, contrastive: 1.2649, 
Iteration 3251/3532 took 0.2973 s, ETA: 80.72 s, loss: 1.0719, loss_avg: ('1.2364',), lr: 0.000000, contrastive: 1.0719, 
Iteration 3301/3532 took 0.2882 s, ETA: 66.37 s, loss: 1.2672, loss_avg: ('1.2362',), lr: 0.000000, contrastive: 1.2672, 
Iteration 3351/3532 took 0.2922 s, ETA: 52.00 s, loss: 1.1235, loss_avg: ('1.2359',), lr: 0.000000, contrastive: 1.1235, 
Iteration 3401/3532 took 0.2804 s, ETA: 37.63 s, loss: 1.3095, loss_avg: ('1.2359',), lr: 0.000000, contrastive: 1.3095, 
Iteration 3451/3532 took 0.2833 s, ETA: 23.26 s, loss: 1.2350, loss_avg: ('1.2358',), lr: 0.000000, contrastive: 1.2350, 
Iteration 3501/3532 took 0.3091 s, ETA: 8.90 s, loss: 1.2258, loss_avg: ('1.2358',), lr: 0.000000, contrastive: 1.2258, 
Epoch: 5, Train Loss = 1.236, Lr = 0.000000

------------------------------[Evaluate]------------------------------
Extract Features and Compute Scores:
Recall@1: 56.3141 - Recall@5: 81.1514 - Recall@10: 86.4895 - Recall@top1: 96.0075 - AP: 67.0139 - SDM@1: 0.7939 - SDM@3: 0.7315 - SDM@5: 0.6871 - Dis@1: 409.4307 - Dis@3: 595.3200 - Dis@5: 722.7492
